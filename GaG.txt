setclipboard("https://discord.gg/dmBzVaRrD3")

-- Services
local Workspace = game:GetService("Workspace")
local Players = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local TweenService = game:GetService("TweenService")
local VirtualUser = game:GetService("VirtualUser")
local GuiService = game:GetService("GuiService")
local VirtualInputManager = game:GetService("VirtualInputManager")
local HttpService = game:GetService("HttpService")
local TeleportService = game:GetService("TeleportService")

-- Player and Character
local lp = Players.LocalPlayer
local char = lp.Character or lp.CharacterAdded:Wait()
local hrp = char:WaitForChild("HumanoidRootPart")
local oldCFrame = hrp.CFrame
local leaderstats = lp:FindFirstChild("leaderstats")
local shecklesStat = leaderstats and leaderstats:FindFirstChild("Sheckles")
local RS, Players = game:GetService("ReplicatedStorage"), game:GetService("Players")
local PetName, PetWeight, PetAge = "", "", ""

-- Remotes and Paths
local GameEvents = ReplicatedStorage:WaitForChild("GameEvents")
local seedRemote = GameEvents:WaitForChild("BuySeedStock")
local gearRemote = GameEvents:WaitForChild("BuyGearStock")
local TwilightRemote = GameEvents:WaitForChild("BuyNightEventShopStock")
local easterRemote = GameEvents:WaitForChild("BuyEasterStock")
local dmRemote = GameEvents:WaitForChild("BuyEventShopStock")
local plantRemote = GameEvents:WaitForChild("Plant_RE")
local favoriteEvent = GameEvents:WaitForChild("Favorite_Item")
local seedPath = lp.PlayerGui.Seed_Shop.Frame.ScrollingFrame
local gearPath = lp.PlayerGui.Gear_Shop.Frame.ScrollingFrame
local bmPath = lp.PlayerGui.EventShop_UI.Frame.ScrollingFrame

-- Constants
local ProductId = 3268187638
local CLICK_DELAY = 0.00000001
local MAX_DISTANCE = 50
local RANGE = 50
local flySpeed = 48

-- Item Lists
local seedItems = {"Carrot", "Strawberry", "Blueberry", "Orange Tulip", "Tomato", "Corn", "Daffodil", "Watermelon", "Pumpkin", "Apple", "Bamboo", "Coconut", "Cactus", "Dragon Fruit", "Mango", "Grape", "Mushroom", "Pepper", "Cacao", "Beanstalk"}
local gearItems = {"Watering Can", "Trowel", "Recall Wrench", "Basic Sprinkler", "Advanced Sprinkler", "Godly Sprinkler", "Lightning Rod", "Master Sprinkler", "Favorite Tool", "Harvest Tool"}
local TwilightItems = {"Night Egg", "Night Seed Pack", "Twilight Crate", "Star Caller", "Moon Cat", "Celestiberry", "Moon Mango"}
local mutationOptions = {"Wet", "Gold", "Frozen", "Rainbow", "Choc", "Chilled", "Shocked", "Moonlit", "Bloodlit", "Celestial", "Plasma", "Disco", "Zombified"}
local seedNames = {"Apple", "Banana", "Bamboo", "Blueberry", "Candy Blossom", "Candy Sunflower", "Carrot", "Cactus", "Chocolate Carrot", "Chocolate Sprinkler", "Coconut", "Corn", "Cranberry", "Cucumber", "Cursed Fruit", "Candy Blossom", "Daffodil", "Dragon Fruit", "Durian", "Easter Egg", "Eggplant", "Grape", "Lemon", "Lotus", "Mango", "Mushroom", "Pepper", "Orange Tulip", "Papaya", "Passionfruit", "Peach", "Pear", "Pineapple", "Pumpkin", "Raspberry", "Red Lollipop", "Soul Fruit", "Strawberry", "Tomato", "Venus Fly Trap", "Watermelon", "Cacao", "Beanstalk"}

-- State Variables
local autoBuyEnabled = false
local autoBuyEnabledE = false
local autoFarmEnabled = false
local fastClickEnabled = false
local autoSellEnabled = false
local HarvestEnabled = false
local flyEnabled = false
local noclip = false
local infJump = false
local spamE = false
local enabled = false
local BAnanaDupeE = false
local autoFavoriteEnabled = false
local autoClaimToggle = false
local autoSkipEnabled = false
local AutoPlanting = false
local CurrentlyPlanting = false
local autoMoon = false
local EasterShopBuyEnabled = false
local Autoegg_autoBuyEnabled = false
local Autoegg_firstRun = true
local selectedSeeds = {"Beanstalk", "Pepper", "Cacao"}
local SelectedSeeds = {"Beanstalk", "Pepper", "Cacao"}
local selectedGears = {"Master Sprinkler", "Godly Sprinkler", "Harvest Tool"}
local selectedTwilight = {"Moon Mango", "Celestiberry", "Twilight Crate"}
local EasterShopSelectedItems = {}, {}, {}, {}, EasterShopItems
local selectedMutations = {"Gold", "Frozen", "Rainbow", "Choc", "Chilled", "Shocked", "Moonlit", "Bloodlit", "Celestial"}
local state = {
    selectedMutations = {"Bloodlit", "Celestial", "Disco", "Zombified", "Plasma"},
    espEnabled = false,
    espBillboards = {},
    espHighlights = {},
    webhookUrl = ""
}
local mutationColors = {
    Wet = Color3.fromRGB(0, 0, 255),
    Gold = Color3.fromRGB(255, 215, 0),
    Frozen = Color3.fromRGB(135, 206, 250),
    Rainbow = Color3.fromRGB(255, 255, 255),
    Choc = Color3.fromRGB(139, 69, 19),
    Chilled = Color3.fromRGB(0, 255, 255),
    Shocked = Color3.fromRGB(255, 255, 100),
    Moonlit = Color3.fromRGB(128, 0, 128),
    Bloodlit = Color3.fromRGB(200, 0, 0),
    Celestial = Color3.fromRGB(200, 150, 255)
}

-- Runtime Variables
local farms = {}
local plants = {}
local farmThread, fastClickThread, autoSellThread, HarvestConnection, flightConnection, collectionThread, descendantConnection, connection, claimConnection, BananaDupe
local bodyVelocity, bodyGyro
local promptTracker = {}
local notifiedFruits = {}

lp.PlayerGui.Hud_UI.SideBtns.Spin.Visible = true
lp.PlayerGui.Hud_UI.SideBtns.StarterPack.Visible = true
lp.PlayerGui.Teleport_UI.Frame.Pets.Visible = true
local gearicon = lp.PlayerGui.Teleport_UI.Frame.Gear
gearicon.Visible = true
gearicon.ImageColor3 = Color3.fromRGB(255, 255, 255)

-- Utility Functions
local function parseMoney(moneyStr)
    if not moneyStr then return 0 end
    moneyStr = tostring(moneyStr):gsub("ÃƒÆ’Ã†â€™Ãƒâ€ Ã¢â‚¬â„¢ÃƒÆ’Ã‚Â¢ÃƒÂ¢Ã¢â‚¬Å¡Ã‚Â¬Ãƒâ€¦Ã‚Â¡ÃƒÆ’Ã†â€™ÃƒÂ¢Ã¢â€šÂ¬Ã…Â¡ÃƒÆ’Ã¢â‚¬Å¡Ãƒâ€šÃ‚Â¢", ""):gsub(",", ""):gsub(" ", ""):gsub("%$", "")
    local multiplier = 1
    if moneyStr:lower():find("k") then
        multiplier = 1000
        moneyStr = moneyStr:lower():gsub("k", "")
    elseif moneyStr:lower():find("m") then
        multiplier = 1000000
        moneyStr = moneyStr:lower():gsub("m", "")
    end
    return (tonumber(moneyStr) or 0) * multiplier
end

local function getPlayerMoney()
    return parseMoney((shecklesStat and shecklesStat.Value) or 0)
end

local function isInventoryFull()
    return #lp.Backpack:GetChildren() >= 200
end

-- Auto Farm Functions
local function updateFarmData()
    farms = {}
    plants = {}
    for _, farm in pairs(workspace:FindFirstChild("Farm"):GetChildren()) do
        local data = farm:FindFirstChild("Important") and farm.Important:FindFirstChild("Data")
        if data and data:FindFirstChild("Owner") and data.Owner.Value == lp.Name then
            table.insert(farms, farm)
            local plantsFolder = farm.Important:FindFirstChild("Plants_Physical")
            if plantsFolder then
                for _, plantModel in pairs(plantsFolder:GetChildren()) do
                    for _, part in pairs(plantModel:GetDescendants()) do
                        if part:IsA("BasePart") and part:FindFirstChildOfClass("ProximityPrompt") then
                            table.insert(plants, part)
                            break
                        end
                    end
                end
            end
        end
    end
end

local function glitchTeleport(pos)
    if not lp.Character then return end
    local root = lp.Character:FindFirstChild("HumanoidRootPart")
    if not root then return end
    local tween = TweenService:Create(root, TweenInfo.new(0.15, Enum.EasingStyle.Linear), {CFrame=CFrame.new(pos + Vector3.new(0, 5, 0))})
    tween:Play()
end

local function instantFarm()
    if farmThread then task.cancel(farmThread) end
    farmThread = task.spawn(function()
        while autoFarmEnabled do
            while isInventoryFull() do
                if not autoFarmEnabled then return end
                task.wait(1)
            end
            if not autoFarmEnabled then return end
            updateFarmData()
            for _, part in pairs(plants) do
                if not autoFarmEnabled then return end
                if isInventoryFull() then break end
                if part and part.Parent then
                    local prompt = part:FindFirstChildOfClass("ProximityPrompt")
                    if prompt then
                        glitchTeleport(part.Position)
                        task.wait(0.2)
                        for _, farm in pairs(farms) do
                            if not autoFarmEnabled or isInventoryFull() then break end
                            for _, obj in pairs(farm:GetDescendants()) do
                                if obj:IsA("ProximityPrompt") then
                                    local str = tostring(obj.Parent)
                                    if not (str:find("Grow_Sign") or str:find("Core_Part")) then
                                        fireproximityprompt(obj, 1)
                                    end
                                end
                            end
                        end
                        if not autoFarmEnabled then return end
                        task.wait(0.2)
                    end
                end
            end
            if autoFarmEnabled then task.wait(0.1) end
        end
    end)
end

-- Auto Collect Functions
local function isValidPrompt(prompt)
    local parent = prompt.Parent
    if not parent then return false end
    local name = parent.Name:lower()
    return not (name:find("sign") or name:find("core"))
end

local function getNearbyPrompts()
    local nearby = {}
    local hrp = lp.Character and lp.Character:FindFirstChild("HumanoidRootPart")
    if not hrp then return nearby end
    
    for _, farm in pairs(workspace.Farm:GetChildren()) do
        local data = farm:FindFirstChild("Important") and farm.Important:FindFirstChild("Data")
        if data and data:FindFirstChild("Owner") and data.Owner.Value == lp.Name then
            for _, obj in pairs(farm:GetDescendants()) do
                if obj:IsA("ProximityPrompt") and isValidPrompt(obj) then
                    local part = obj.Parent
                    if part:IsA("BasePart") then
                        local dist = (hrp.Position - part.Position).Magnitude
                        if dist <= MAX_DISTANCE then
                            table.insert(nearby, obj)
                        end
                    end
                end
            end
        end
    end
    return nearby
end

local function fastClickFarm()
    if fastClickThread then task.cancel(fastClickThread) end
    fastClickThread = task.spawn(function()
        while fastClickEnabled do
            if isInventoryFull() then
                task.wait(1)
                continue
            end
            local prompts = getNearbyPrompts()
            for _, prompt in pairs(prompts) do
                if not fastClickEnabled then return end
                if isInventoryFull() then break end
                fireproximityprompt(prompt, 1)
                task.wait(CLICK_DELAY)
            end
            task.wait(0.1)
        end
    end)
end

-- Auto Sell Functions
local function sellItems()
    local steven = workspace.NPCS:FindFirstChild("Steven")
    if not steven then return false end
    
    local char = lp.Character
    if not char then return false end
    
    local hrp = char:FindFirstChild("HumanoidRootPart")
    if not hrp then return false end
    
    local originalPosition = hrp.CFrame
    hrp.CFrame = steven.HumanoidRootPart.CFrame * CFrame.new(0, 3, 3)
    task.wait(0.5)
    
    for _ = 1, 5 do
        pcall(function()
            ReplicatedStorage.GameEvents.Sell_Inventory:FireServer()
        end)
        task.wait(0.15)
    end
    
    hrp.CFrame = originalPosition
    return true
end

-- Harvest Functions
local function FindGarden()
    local farm = workspace:FindFirstChild("Farm")
    if not farm then return nil end
    
    for _, plot in ipairs(farm:GetChildren()) do
        local data = plot:FindFirstChild("Important") and plot.Important:FindFirstChild("Data")
        local owner = data and data:FindFirstChild("Owner")
        if owner and owner.Value == lp.Name then
            return plot
        end
    end
    return nil
end

local function CanHarvest(part)
    local prompt = part:FindFirstChild("ProximityPrompt")
    return prompt and prompt.Enabled
end

local function Harvest()
    if not HarvestEnabled then return end
    if isInventoryFull() then return end
    
    local garden = FindGarden()
    if not garden then return end
    
    local plants = garden:FindFirstChild("Important") and garden.Important:FindFirstChild("Plants_Physical")
    if not plants then return end
    
    for _, plant in ipairs(plants:GetChildren()) do
        if not HarvestEnabled then break end
        local fruits = plant:FindFirstChild("Fruits")
        if fruits then
            for _, fruit in ipairs(fruits:GetChildren()) do
                if not HarvestEnabled then break end
                for _, part in ipairs(fruit:GetChildren()) do
                    if not HarvestEnabled then break end
                    if part:IsA("BasePart") and CanHarvest(part) then
                        local prompt = part.ProximityPrompt
                        local pos = part.Position + Vector3.new(0, 3, 0)
                        if lp.Character and lp.Character.PrimaryPart then
                            lp.Character:SetPrimaryPartCFrame(CFrame.new(pos))
                            task.wait(0.1)
                            if not HarvestEnabled then break end
                            prompt:InputHoldBegin()
                            task.wait(0.1)
                            if not HarvestEnabled then break end
                            prompt:InputHoldEnd()
                            task.wait(0.1)
                        end
                    end
                end
            end
        end
    end
end

local function ToggleHarvest(state)
    if HarvestConnection then
        HarvestConnection:Disconnect()
        HarvestConnection = nil
    end
    HarvestEnabled = state
    if state then
        HarvestConnection = RunService.Heartbeat:Connect(function()
            if HarvestEnabled then
                Harvest()
            else
                HarvestConnection:Disconnect()
                HarvestConnection = nil
            end
        end)
    end
end

-- Movement Functions
local function Fly(state)
    flyEnabled = state
    if flyEnabled then
        local character = lp.Character
        if not character or not character:FindFirstChild("HumanoidRootPart") then return end
        
        local humanoid = character:FindFirstChildOfClass("Humanoid")
        if not humanoid then return end
        
        bodyGyro = Instance.new("BodyGyro")
        bodyVelocity = Instance.new("BodyVelocity")
        bodyGyro.P = 9000
        bodyGyro.maxTorque = Vector3.new(8999999488, 8999999488, 8999999488)
        bodyGyro.cframe = character.HumanoidRootPart.CFrame
        bodyGyro.Parent = character.HumanoidRootPart
        
        bodyVelocity.velocity = Vector3.new(0, 0, 0)
        bodyVelocity.maxForce = Vector3.new(8999999488, 8999999488, 8999999488)
        bodyVelocity.Parent = character.HumanoidRootPart
        humanoid.PlatformStand = true
        
        flightConnection = RunService.Heartbeat:Connect(function()
            if not flyEnabled or not character:FindFirstChild("HumanoidRootPart") then
                if flightConnection then flightConnection:Disconnect() end
                return
            end
            
            local cam = workspace.CurrentCamera.CFrame
            local moveVec = Vector3.new()
            
            if UserInputService:IsKeyDown(Enum.KeyCode.W) then
                moveVec = moveVec + cam.LookVector
            end
            if UserInputService:IsKeyDown(Enum.KeyCode.S) then
                moveVec = moveVec - cam.LookVector
            end
            if UserInputService:IsKeyDown(Enum.KeyCode.A) then
                moveVec = moveVec - cam.RightVector
            end
            if UserInputService:IsKeyDown(Enum.KeyCode.D) then
                moveVec = moveVec + cam.RightVector
            end
            
            if moveVec.Magnitude > 0 then
                moveVec = moveVec.Unit * flySpeed
            end
            if UserInputService:IsKeyDown(Enum.KeyCode.Space) then
                moveVec = moveVec + Vector3.new(0, flySpeed, 0)
            end
            if UserInputService:IsKeyDown(Enum.KeyCode.LeftShift) then
                moveVec = moveVec + Vector3.new(0, -flySpeed, 0)
            end
            
            bodyVelocity.velocity = moveVec
            bodyGyro.cframe = cam
        end)
    else
        if bodyVelocity then bodyVelocity:Destroy() end
        if bodyGyro then bodyGyro:Destroy() end
        
        local character = lp.Character
        if character then
            local humanoid = character:FindFirstChildOfClass("Humanoid")
            if humanoid then
                humanoid.PlatformStand = false
            end
        end
        
        if flightConnection then
            flightConnection:Disconnect()
            flightConnection = nil
        end
    end
end

local function ToggleNoclip(state)
    noclip = state
end

RunService.Stepped:Connect(function()
    if noclip then
        for _, part in ipairs(char:GetDescendants()) do
            if part:IsA("BasePart") and part.CanCollide == true then
                part.CanCollide = false
            end
        end
    end
end)

local function ToggleInfJump(state)
    infJump = state
end

UserInputService.JumpRequest:Connect(function()
    if infJump and char and char:FindFirstChildOfClass("Humanoid") then
        char:FindFirstChildOfClass("Humanoid"):ChangeState(Enum.HumanoidStateType.Jumping)
    end
end)

-- Shop Functions
local function OpenShop()
    local shop = lp.PlayerGui.Seed_Shop
    shop.Enabled = not shop.Enabled
end

local function OpenGearShop()
    local gear = lp.PlayerGui.Gear_Shop
    gear.Enabled = not gear.Enabled
end

local function OpenEaster()
    local easter = lp.PlayerGui.Easter_Shop
    easter.Enabled = not easter.Enabled
end

local function OpenQuest()
    local quest = lp.PlayerGui.DailyQuests_UI
    quest.Enabled = not quest.Enabled
end

local function OpenBloodShop()
    local Bs = lp.PlayerGui.EventShop_UI
    Bs.Enabled = not Bs.Enabled
end

local function OpenCosmetic()
    local Bs = lp.PlayerGui.CosmeticShop_UI
    Bs.Enabled = not Bs.Enabled
end

local function OpenTwilight()
    local Bs = lp.PlayerGui.NightEventShop_UI
    Bs.Enabled = not Bs.Enabled
end

local function OpenTwilightQuest()
    local Bs = lp.PlayerGui.NightQuest_UI
    Bs.Enabled = not Bs.Enabled
end

local function EggShop1()
    fireproximityprompt(workspace.NPCS["Pet Stand"].EggLocations["Common Egg"].ProximityPrompt)
end

local function EggShop2()
    fireproximityprompt(workspace.NPCS["Pet Stand"].EggLocations:GetChildren()[6].ProximityPrompt)
end

local function EggShop3()
    fireproximityprompt(workspace.NPCS["Pet Stand"].EggLocations:GetChildren()[5].ProximityPrompt)
end

-- Auto Buy Egg
local Autoegg_npc = workspace:WaitForChild("NPCS"):WaitForChild("Pet Stand")
local Autoegg_timer = Autoegg_npc.Timer.SurfaceGui:WaitForChild("ResetTimeLabel")
local Autoegg_eggLocations = Autoegg_npc:WaitForChild("EggLocations")
local Autoegg_events = GameEvents

local function Autoegg_safeFirePrompt(prompt)
    if prompt then
        pcall(function()
            fireproximityprompt(prompt)
        end)
    end
end

local function Autoegg_safeFireServer(id)
    pcall(function()
        Autoegg_events:WaitForChild("BuyPetEgg"):FireServer(id)
    end)
end

local function Autoegg_setAlwaysShow()
    for _, obj in ipairs(Autoegg_eggLocations:GetChildren()) do
        for _, child in ipairs(obj:GetDescendants()) do
            if child:IsA("ProximityPrompt") then
                child.Exclusivity = Enum.ProximityPromptExclusivity.AlwaysShow
            end
        end
    end
end

local function Autoegg_autoBuyEggs()
    if Autoegg_autoBuyEnabled then
        if not Autoegg_firstRun then
            while Autoegg_timer.Text ~= "00:00:00" do
                task.wait(0.1)
            end
            task.wait(3)
        else
            Autoegg_firstRun = false
        end

        if not lp.Character or not lp.Character:FindFirstChild("HumanoidRootPart") then return end
        lp.Character.HumanoidRootPart.CFrame = CFrame.new(-255.12291, 2.99999976, -1.13749218, -0.0163238496, 1.05261321e-07, 0.999866784, -5.92361182e-09, 1, -1.0537206e-07, -0.999866784, -7.64290053e-09, -0.0163238496)

        Autoegg_setAlwaysShow()

        local commonEggPrompt = Autoegg_eggLocations:FindFirstChild("Common Egg")
        if commonEggPrompt then
            Autoegg_safeFirePrompt(commonEggPrompt:FindFirstChild("ProximityPrompt"))
            task.wait(0.3)
            Autoegg_safeFireServer(1)
        end

        local eggSlot6 = Autoegg_eggLocations:GetChildren()[6]
        if eggSlot6 then
            Autoegg_safeFirePrompt(eggSlot6:FindFirstChild("ProximityPrompt"))
            task.wait(0.3)
            Autoegg_safeFireServer(2)
        end

        local eggSlot5 = Autoegg_eggLocations:GetChildren()[5]
        if eggSlot5 then
            Autoegg_safeFirePrompt(eggSlot5:FindFirstChild("ProximityPrompt"))
            task.wait(0.3)
            Autoegg_safeFireServer(3)
        end

        lp.Character.HumanoidRootPart.CFrame = oldCFrame
    end
end

task.spawn(function()
    while true do
        task.wait(0.5)
        if Autoegg_autoBuyEnabled then
            Autoegg_autoBuyEggs()
        end
    end
end)

-- Sell Functions
local function SellAll()
    local steven = workspace.NPCS:FindFirstChild("Steven")
    if steven then
        hrp.CFrame = steven.HumanoidRootPart.CFrame + Vector3.new(0, 3, 0)
        task.wait(0.2)
        GameEvents:WaitForChild("Sell_Inventory"):FireServer()
        
        local farms = workspace:WaitForChild("Farm"):GetChildren()
        for _, farm in pairs(farms) do
            local data = farm:FindFirstChild("Important") and farm.Important:FindFirstChild("Data")
            if data and data:FindFirstChild("Owner") and data.Owner.Value == lp.Name then
                local spawn = farm:FindFirstChild("Spawn_Point")
                if spawn then
                    hrp.CFrame = spawn.CFrame + Vector3.new(0, 3, 0)
                    break
                end
            end
        end
    end
end

local function HSell()
    local steven = workspace.NPCS:FindFirstChild("Steven")
    if steven then
        hrp.CFrame = steven.HumanoidRootPart.CFrame + Vector3.new(0, 3, 0)
        task.wait(0.2)
        GameEvents:WaitForChild("Sell_Item"):FireServer()
        
        local farms = workspace:WaitForChild("Farm"):GetChildren()
        for _, farm in pairs(farms) do
            local data = farm:FindFirstChild("Important") and farm.Important:FindFirstChild("Data")
            if data and data:FindFirstChild("Owner") and data.Owner.Value == lp.Name then
                local spawn = farm:FindFirstChild("Spawn_Point")
                if spawn then
                    hrp.CFrame = spawn.CFrame + Vector3.new(0, 3, 0)
                    break
                end
            end
        end
    end
end

local function AutoGiveFruitMoon(state)
    autoMoon = state
    task.spawn(function()
        while autoMoon do
            local backpack = lp:FindFirstChild("Backpack")
            local character = lp.Character or lp.CharacterAdded:Wait()
            if backpack and character then
                for _, tool in pairs(backpack:GetChildren()) do
                    if tool:IsA("Tool") and string.find(tool.Name, "%[Moonlit%]") then
                        tool.Parent = character
                        task.wait(0.5)
                        for _ = 1, 10 do
                            GameEvents.NightQuestRemoteEvent:FireServer("SubmitHeldPlant")
                        end
                        task.wait(0.5)
                    end
                end
            end
            task.wait(0.5)
        end
    end)
end

-- Auto Collect V2 Functions
local function modifyPrompt(prompt, show)
    pcall(function()
        prompt.RequiresLineOfSight = not show
        prompt.Exclusivity = show and Enum.ProximityPromptExclusivity.AlwaysShow or Enum.ProximityPromptExclusivity.One
    end)
end

local function isInsideFarm(part)
    for _, farm in pairs(farms) do
        if part:IsDescendantOf(farm) then
            return true
        end
    end
    return false
end

local function handleNewPrompt(prompt)
    if not prompt:IsA("ProximityPrompt") then return end
    if not isInsideFarm(prompt) then return end
    
    if not promptTracker[prompt] then
        promptTracker[prompt] = {
            originalRequiresLOS = prompt.RequiresLineOfSight,
            originalExclusivity = prompt.Exclusivity
        }
    end
    
    modifyPrompt(prompt, spamE)
    prompt.AncestryChanged:Connect(function(_, parent)
        if parent == nil then
            promptTracker[prompt] = nil
        end
    end)
end

-- One Click Remove Functions
local function OneClickRemove(state)
    enabled = state
    local confirmFrame = lp.PlayerGui:FindFirstChild("ShovelPrompt")
    if confirmFrame and confirmFrame:FindFirstChild("ConfirmFrame") then
        confirmFrame.ConfirmFrame.Visible = not state
    end
end

-- Destroy Sign Function
local function DestroySign()
    for _, farm in pairs(workspace.Farm:GetChildren()) do
        local sign = farm:FindFirstChild("Sign")
        if sign then
            local core = sign:FindFirstChild("Core_Part")
            if core then
                for _, obj in pairs(core:GetDescendants()) do
                    if obj:IsA("ProximityPrompt") then
                        obj:Destroy()
                    end
                end
            end
        end
        
        local growSign = farm:FindFirstChild("Grow_Sign")
        if growSign then
            for _, obj in pairs(growSign:GetDescendants()) do
                if obj:IsA("ProximityPrompt") then
                    obj:Destroy()
                end
            end
        end
    end
end

-- Auto Favorite Functions
local function toolMatchesMutation(toolName)
    for _, mutation in ipairs(selectedMutations) do
        if string.find(toolName, mutation) then
            return true
        end
    end
    return false
end

local function isToolFavorited(tool)
    return tool:GetAttribute("Favorite") or (tool:FindFirstChild("Favorite") and tool.Favorite.Value)
end

local function favoriteToolIfMatches(tool)
    if toolMatchesMutation(tool.Name) and not isToolFavorited(tool) then
        favoriteEvent:FireServer(tool)
        task.wait(0.1)
    end
end

local function processBackpack()
    local backpack = lp:FindFirstChild("Backpack") or lp:WaitForChild("Backpack")
    for _, tool in ipairs(backpack:GetChildren()) do
        favoriteToolIfMatches(tool)
    end
end

local function setupAutoFavorite()
    if connection then connection:Disconnect() end
    local backpack = lp:WaitForChild("Backpack")
    connection = backpack.ChildAdded:Connect(function(tool)
        task.wait(0.1)
        favoriteToolIfMatches(tool)
    end)
    processBackpack()
end

-- Auto Claim Premium Seeds Functions
local function claimPremiumSeed()
    GameEvents.SeedPackGiverEvent:FireServer("ClaimPremiumPack")
end

local function toggleAutoClaim(newState)
    autoClaimToggle = newState
    if claimConnection then
        claimConnection:Disconnect()
        claimConnection = nil
    end
    if autoClaimToggle then
        claimConnection = RunService.Heartbeat:Connect(function()
            claimPremiumSeed()
            task.wait()
        end)
    end
end

-- Auto Open Crate Functions
local function toggleAutoSkip()
    autoSkipEnabled = not autoSkipEnabled
    if autoSkipEnabled then
        task.spawn(function()
            local character = lp.Character
            local backpack = lp:FindFirstChild("Backpack")
            local seedTool
            if backpack then
                for _, tool in ipairs(backpack:GetChildren()) do
                    if tool:IsA("Tool") and tool.Name:find("Basic Seed Pack") then
                        seedTool = tool
                        break
                    end
                end
            end
            if seedTool and character then
                seedTool.Parent = character
            end
            
            while autoSkipEnabled do
                local PlayerGui = lp:FindFirstChild("PlayerGui")
                local RollCrate_UI = PlayerGui and PlayerGui:FindFirstChild("RollCrate_UI")
                local character = lp.Character
                local equippedTool = character and character:FindFirstChildOfClass("Tool")
                local holdingSeed = equippedTool and equippedTool.Name:find("Basic Seed Pack")
                
                if RollCrate_UI then
                    if RollCrate_UI.Enabled then
                        local Frame = RollCrate_UI:FindFirstChild("Frame")
                        local Button = Frame and Frame:FindFirstChild("Skip")
                        if Button and Button:IsA("ImageButton") and Button.Visible then
                            GuiService.SelectedObject = Button
                            VirtualInputManager:SendKeyEvent(true, Enum.KeyCode.Return, false, game)
                            VirtualInputManager:SendKeyEvent(false, Enum.KeyCode.Return, false, game)
                        end
                    elseif holdingSeed then
                        VirtualInputManager:SendMouseButtonEvent(0, 0, 0, true, game, 1)
                        VirtualInputManager:SendMouseButtonEvent(0, 0, 0, false, game, 1)
                    end
                end
                task.wait(0.1)
            end
        end)
    end
end

-- Server Hop Function
local function ServerHop()
    local servers = {}
    local cursor = nil
    repeat
        local url = "https://games.roblox.com/v1/games/" .. game.PlaceId .. "/servers/Public?sortOrder=Asc&limit=100"
        if cursor then url = url .. "&cursor=" .. cursor end
        local data = HttpService:JSONDecode(game:HttpGet(url))
        for _, server in ipairs(data.data) do
            table.insert(servers, server.id)
        end
        cursor = data.nextPageCursor
    until not cursor or #servers > 0
    if #servers == 0 then return end
    TeleportService:TeleportToPlaceInstance(game.PlaceId, servers[math.random(1, #servers)], lp)
end

-- Auto Plant Functions
local function getPlayerPosition()
    local char = lp.Character or lp.CharacterAdded:Wait()
    local root = char:FindFirstChild("HumanoidRootPart")
    return root and root.Position or Vector3.zero
end

local function getCurrentSeedsInBackpack()
    local result = {}
    for _, tool in ipairs(lp.Backpack:GetChildren()) do
        if tool:IsA("Tool") then
            local base = tool.Name:match("^(.-) Seed")
            if base and table.find(SelectedSeeds, base) then
                result[#result + 1] = {BaseName = base, Tool = tool}
            end
        end
    end
    return result
end

local function plantEquippedSeed(seedName)
    local pos = getPlayerPosition()
    plantRemote:FireServer(pos, seedName)
end

local function equipTool(tool)
    if not tool or not tool:IsDescendantOf(lp.Backpack) then return end
    pcall(function()
        lp.Character.Humanoid:UnequipTools()
        task.wait(0.1)
        tool.Parent = lp.Character
        while not lp.Character:FindFirstChild(tool.Name) do
            task.wait(0.1)
        end
    end)
end

local function startAutoPlanting()
    if CurrentlyPlanting then return end
    CurrentlyPlanting = true
    task.spawn(function()
        while AutoPlanting do
            local seeds = getCurrentSeedsInBackpack()
            for _, data in ipairs(seeds) do
                local tool = data.Tool
                local seedName = data.BaseName
                if not table.find(SelectedSeeds, seedName) then continue end
                if tool and tool:IsA("Tool") and tool:IsDescendantOf(lp.Backpack) then
                    equipTool(tool)
                    task.wait(0.2)
                    while AutoPlanting and lp.Character:FindFirstChild(tool.Name) do
                        if not table.find(SelectedSeeds, seedName) then break end
                        plantEquippedSeed(seedName)
                        task.wait(0.1)
                    end
                end
            end
            task.wait(0.1)
        end
        CurrentlyPlanting = false
    end)
end

-- Destroy Others Farm Function
local function DestroyOthersFarm()
    local farms = workspace:FindFirstChild("Farm")
    if not farms then return end
    for _, farm in pairs(farms:GetChildren()) do
        local data = farm:FindFirstChild("Important") and farm.Important:FindFirstChild("Data")
        if data and data:FindFirstChild("Owner") and data.Owner.Value ~= lp.Name then
            local plants = farm:FindFirstChild("Important") and farm.Important:FindFirstChild("Plants_Physical")
            if plants then
                for _, obj in pairs(plants:GetChildren()) do
                    obj:Destroy()
                end
            end
        end
    end
end

-- ESP Functions
local function createESP(fruitModel)
    if state.espBillboards[fruitModel] then
        state.espBillboards[fruitModel]:Destroy()
        state.espBillboards[fruitModel] = nil
    end
    if state.espHighlights[fruitModel] then
        state.espHighlights[fruitModel]:Destroy()
        state.espHighlights[fruitModel] = nil
    end
    if not state.espEnabled then return end
    local activeMutations = {}
    for _, mutation in ipairs(mutationOptions) do
        if table.find(state.selectedMutations, mutation) and fruitModel:GetAttribute(mutation) then
            table.insert(activeMutations, mutation)
        end
    end
    if #activeMutations == 0 then return end
    local text = fruitModel.Name .. " - " .. table.concat(activeMutations, ", ")
    local espColor = mutationColors[activeMutations[1]] or Color3.fromRGB(255, 255, 255)
    local highlight = Instance.new("Highlight")
    highlight.Name = "MutationESP_Highlight"
    highlight.FillTransparency = 1
    highlight.OutlineColor = espColor
    highlight.OutlineTransparency = 0
    highlight.Adornee = fruitModel
    highlight.Parent = fruitModel
    state.espHighlights[fruitModel] = highlight
    local billboard = Instance.new("BillboardGui")
    billboard.Name = "MutationESP"
    billboard.Adornee = fruitModel.PrimaryPart or fruitModel:FindFirstChildWhichIsA("BasePart")
    billboard.Size = UDim2.fromOffset(100, 20)
    billboard.StudsOffset = Vector3.new(0, 2, 0)
    billboard.AlwaysOnTop = true
    billboard.Enabled = true
    local textLabel = Instance.new("TextLabel")
    textLabel.Size = UDim2.fromScale(1, 1)
    textLabel.BackgroundTransparency = 1
    textLabel.Text = "{" .. text .. "}"
    textLabel.TextColor3 = espColor
    textLabel.TextScaled = true
    textLabel.TextStrokeTransparency = 0.5
    textLabel.Font = Enum.Font.SourceSansBold
    textLabel.Parent = billboard
    billboard.Parent = fruitModel
    state.espBillboards[fruitModel] = billboard
end

local function updateESP()
    for _, billboard in pairs(state.espBillboards) do
        billboard:Destroy()
    end
    for _, highlight in pairs(state.espHighlights) do
        highlight:Destroy()
    end
    table.clear(state.espBillboards)
    table.clear(state.espHighlights)
    if not state.espEnabled or not workspace:FindFirstChild("Farm") then return end
    local farms = {}
    for _, farm in ipairs(workspace.Farm:GetChildren()) do
        local data = farm:FindFirstChild("Important") and farm.Important:FindFirstChild("Data")
        if data and data:FindFirstChild("Owner") and data.Owner.Value == lp.Name then
            table.insert(farms, farm)
        end
    end
    for _, farm in ipairs(farms) do
        local plantsFolder = farm.Important:FindFirstChild("Plants_Physical")
        if plantsFolder then
            for _, plantModel in ipairs(plantsFolder:GetChildren()) do
                if plantModel:IsA("Model") then
                    local fruitsFolder = plantModel:FindFirstChild("Fruits")
                    if fruitsFolder then
                        for _, fruitModel in ipairs(fruitsFolder:GetChildren()) do
                            if fruitModel:IsA("Model") then
                                createESP(fruitModel)
                            end
                        end
                    end
                end
            end
        end
    end
end

local function updateMutationCounts()
    local mutationCounts = {}
    for _, mutation in pairs(mutationOptions) do
        mutationCounts[mutation] = 0
    end
    local farms = {}
    for _, farm in pairs(workspace.Farm:GetChildren()) do
        local data = farm:FindFirstChild("Important") and farm.Important:FindFirstChild("Data")
        if data and data:FindFirstChild("Owner") and data.Owner.Value == lp.Name then
            table.insert(farms, farm)
        end
    end
    for _, farm in pairs(farms) do
        local plantsFolder = farm.Important:FindFirstChild("Plants_Physical")
        if plantsFolder then
            for _, plantModel in pairs(plantsFolder:GetChildren()) do
                if plantModel:IsA("Model") then
                    local fruitsFolder = plantModel:FindFirstChild("Fruits")
                    if fruitsFolder then
                        for _, fruitModel in pairs(fruitsFolder:GetChildren()) do
                            if fruitModel:IsA("Model") then
                                local fruitId = fruitModel:GetFullName()
                                local mutationsFound = {}
                                for _, mutation in pairs(mutationOptions) do
                                    if fruitModel:GetAttribute(mutation) then
                                        mutationCounts[mutation] = mutationCounts[mutation] + 1
                                        table.insert(mutationsFound, mutation)
                                    end
                                end
                                if #mutationsFound > 0 and not notifiedFruits[fruitId] and state.espEnabled then
                                    notifiedFruits[fruitId] = true
                                    sendWebhookNotification(plantModel.Name, mutationsFound, lp.Name)
                                end
                            end
                        end
                    end
                end
            end
        end
    end
    local countText = ""
    for _, mutation in pairs(mutationOptions) do
        if mutationCounts[mutation] > 0 then
            countText = countText .. mutation .. ": " .. mutationCounts[mutation] .. ", "
        end
    end
    countText = countText:sub(1, -3)
    if countText == "" then countText = "No mutations found" end
    return countText
end

-- Table to track processed mutations
local processedMutations = {}

-- Webhook Functions
local function sendWebhook(data)
    if not data or type(data) ~= "table" then return end
    local HttpService = game:GetService("HttpService")
    local json = HttpService:JSONEncode(data)
    local request = (syn and syn.request) or (http and http.request) or (http_request) or (request)
    if not request then return end
    local success, result = pcall(request, {
        Url = state.webhookUrl,
        Method = "POST",
        Headers = {["Content-Type"] = "application/json"},
        Body = json
    })
    if not success then
        warn("Failed to send webhook: " .. tostring(result))
        return false
    end
    if result and result.StatusCode and result.StatusCode >= 200 and result.StatusCode < 300 then
        print("Webhook sent successfully!")
        return true
    else
        warn("Webhook failed with status " .. tostring(result.StatusCode) .. ": " .. tostring(result.Body))
        return false
    end
end

local function sendWebhookNotification(fruitName, mutation, farmName)
    if state.webhookUrl == "" then return end

    local webhookData = {
        content = "",
        embeds = {
            {
                title = "ÃƒÂ°Ã…Â¸Ã…â€™Ã‚Â· Mutation Detected! ÃƒÂ°Ã…Â¸Ã…â€™Ã‚Â·",
                description = string.format("A **%s** mutation was found!", mutation),
                color = 0x00FF00,
                fields = {
                    { name = "Fruit", value = fruitName or "Unknown", inline = true },
                    { name = "Farm", value = farmName or "Unknown", inline = true }
                },
                timestamp = os.date("!%Y-%m-%dT%H:%M:%SZ")
            }
        }
    }

    return sendWebhook(webhookData)
end

-- Function to check farms and send notifications for new mutations
local function checkForMutations()
    if not workspace:FindFirstChild("Farm") or state.webhookUrl == "" or #state.selectedMutations == 0 then return end

    local farms = {}
    for _, farm in ipairs(workspace.Farm:GetChildren()) do
        local data = farm:FindFirstChild("Important") and farm.Important:FindFirstChild("Data")
        if data and data:FindFirstChild("Owner") and data.Owner.Value == lp.Name then
            table.insert(farms, farm)
        end
    end

    for _, farm in ipairs(farms) do
        local plantsFolder = farm.Important:FindFirstChild("Plants_Physical")
        if plantsFolder then
            for _, plantModel in ipairs(plantsFolder:GetChildren()) do plantModel:IsA("Model")
                local fruitsFolder = plantModel:FindFirstChild("Fruits")
                if fruitsFolder then
                    for _, fruitModel in ipairs(fruitsFolder:GetChildren()) do fruitModel:IsA("Model")
                        -- Create a unique identifier for this fruit model (e.g., full path)
                        local modelPath = fruitModel:GetFullName()

                        -- Initialize processed mutations for this model if not exists
                        if not processedMutations[modelPath] then
                            processedMutations[modelPath] = {}
                        end

                        -- Check for selected mutations
                        for _, mutation in ipairs(state.selectedMutations) do
                            if fruitModel:GetAttribute(mutation) == true then
                                -- Check if this mutation was already processed
                                if not processedMutations[modelPath][mutation] then
                                    -- Mark as processed
                                    processedMutations[modelPath][mutation] = true
                                    -- Send webhook notification for new mutation
                                    sendWebhookNotification(
                                        plantModel.Name,
                                        mutation,
                                        farm.Name
                                    )
                                    -- Optional: Add a short delay to avoid rate limits
                                    wait(0.5) -- Adjust based on Discord's rate limit (e.g., 30 req/min)
                                end
                            end
                        end
                    end
                end
            end
        end
    end

    -- Optional: Clean up processed mutations for models that no longer exist
    for modelPath in pairs(processedMutations) do
        if not game:GetService("Workspace"):FindFirstChild(modelPath) then
            processedMutations[modelPath] = nil
        end
    end
end

-- UI Setup with WindUI
local WindUI = loadstring(game:HttpGet("https://github.com/Footagesus/WindUI/releases/latest/download/main.lua"))()

local function gradient(text, startColor, endColor)
    local result = ""
    local length = #text
    for i = 1, length do
        local t = (i - 1) / math.max(length - 1, 1)
        local r = math.floor((startColor.R + (endColor.R - startColor.R) * t) * 255)
        local g = math.floor((startColor.G + (endColor.G - startColor.G) * t) * 255)
        local b = math.floor((startColor.B + (endColor.B - startColor.B) * t) * 255)
        local char = text:sub(i, i)
        result = result .. "<font color=\"rgb(" .. r ..", " .. g .. ", " .. b .. ")\">" .. char .. "</font>"
    end
    return result
end

local Confirmed = false
WindUI:Popup({
    Title = "Welcome to Grow a Garden!",
    Icon = "info",
    Content = "This is the " .. gradient("PolleserHub", Color3.fromHex("#00FF87"), Color3.fromHex("#60EFFF")) .. " UI for Grow a Garden",
    Buttons = {
        {
            Title = "Cancel",
            Variant = "Secondary",
            Callback = function() end
        },
        {
            Title = "Continue",
            Icon = "arrow-right",
            Callback = function() Confirmed = true end,
            Variant = "Primary"
        }
    }
})

repeat wait() until Confirmed

local Window = WindUI:CreateWindow({
    Title = "Grow a Garden | PolleserHub",
    Icon = "flower",
    Author = "Polleser",
    Folder = "PolleserHub",
    Size = UDim2.fromOffset(580, 460),
    Transparent = true,
    Theme = "Ocean",
    User = {
        Enabled = true,
        Callback = function() print("User clicked") end,
        Anonymous = true
    },
    SideBarWidth = 200,
    HasOutline = true,
    KeySystem = {
        Key = {
            "GaGBNfidudhdbKsksjd", "TesterKey000104", "PermKey001827367281", "PermKey161892947188",
            "PermKey929474728199", "PermKey199293747291", "PermKey189193747381", "PermKey947493973892",
            "PermKey183947749292", "PermKey648291927377", "PermKey179104847372", "PermKey632892938488",
            "PermKey940402727289", "PermKey059472626183", "PermKey950492717183", "PermKey050472719199",
            "PermKey500372628394", "PermKey040381618030", "PermKey508271728394", "PermKey192747483929",
            "PermKey728199487473", "PermKey010284746371", "PermKey101082736282"
        },
        Note = "To get the Script's Key, join our Discord server: https://discord.gg/dmBzVaRrD3",
        SaveKey = true
    }
})

Window:EditOpenButton({
    Title = "Open PolleserHub",
    Icon = "monitor",
    CornerRadius = UDim.new(0, 16),
    StrokeThickness = 2,
    Color = ColorSequence.new(Color3.fromHex("FF0F7B"), Color3.fromHex("F89B29")),
    Draggable = true
})

-- Tabs
local Tabs = {
    MainTab = Window:Tab({ Title = "Main", Icon = "flower", Desc = "Main automation features" }),
    ShopTab = Window:Tab({ Title = "Shop", Icon = "shopping-cart", Desc = "Shop and purchase options" }),
    PlayerTab = Window:Tab({ Title = "Players", Icon = "user", Desc = "Player movement and settings" }),
    MiscTab = Window:Tab({ Title = "Miscellaneous", Icon = "list", Desc = "Additional features" }),
    SpawnerTab = Window:Tab({ Title = "Spawner", Icon = "paw-print", Desc = "Spawn seeds and pets" }),
    VisualsTab = Window:Tab({ Title = "Visuals", Icon = "eye", Desc = "Visual enhancements and ESP" })
}

Window:SelectTab(1)

-- Main Tab
Tabs.MainTab:Paragraph({ Title = "Auto Farm", Desc = "Automation features for farming" })
Tabs.MainTab:Toggle({
    Title = "Auto Farm",
    Value = false,
    Callback = function(state)
        autoFarmEnabled = state
        if state then instantFarm() else if farmThread then task.cancel(farmThread) farmThread = nil end end
    end
})
Tabs.MainTab:Toggle({
    Title = "Auto Farm v2",
    Desc = "Make sure you look down! May not collect sometimes. Bad for packed areas!",
    Value = false,
    Callback = ToggleHarvest
})
Tabs.MainTab:Toggle({
    Title = "Auto Collect",
    Value = false,
    Callback = function(state)
        fastClickEnabled = state
        if state then fastClickFarm() else if fastClickThread then task.cancel(fastClickThread) fastClickThread = nil end end
    end
})
Tabs.MainTab:Toggle({
    Title = "Auto Collect V2",
    Desc = "Automatically collects fruits near you",
    Value = false,
    Callback = function(Value)
        spamE = Value
        updateFarmData()
        for _, farm in pairs(farms) do
            for _, obj in ipairs(farm:GetDescendants()) do
                if obj:IsA("ProximityPrompt") then handleNewPrompt(obj) end
            end
        end
        if spamE then
            collectionThread = task.spawn(function()
                while spamE and task.wait(0.1) do
                    if not isInventoryFull() then
                        local char = lp.Character
                        local root = char and char:FindFirstChild("HumanoidRootPart")
                        if root then
                            for prompt, _ in pairs(promptTracker) do
                                if prompt:IsA("ProximityPrompt") and prompt.Enabled and prompt.KeyboardKeyCode == Enum.KeyCode.E then
                                    local targetPos
                                    local parent = prompt.Parent
                                    if parent:IsA("BasePart") then targetPos = parent.Position
                                    elseif parent:IsA("Model") and parent:FindFirstChild("HumanoidRootPart") then targetPos = parent.HumanoidRootPart.Position end
                                    if targetPos and (root.Position - targetPos).Magnitude <= RANGE then pcall(function() fireproximityprompt(prompt, 1, true) end) end
                                end
                            end
                        end
                    end
                end
            end)
        else
            for prompt, data in pairs(promptTracker) do
                if prompt:IsA("ProximityPrompt") then
                    pcall(function() prompt.RequiresLineOfSight = data.originalRequiresLOS prompt.Exclusivity = data.originalExclusivity end)
                end
            end
            if collectionThread then task.cancel(collectionThread) collectionThread = nil end
        end
    end
})
descendantConnection = workspace.DescendantAdded:Connect(function(obj)
    if obj:IsA("ProximityPrompt") and isInsideFarm(obj) then handleNewPrompt(obj) end
end)
Tabs.MainTab:Toggle({
    Title = "Auto Sell",
    Desc = "Automatically sells when inventory is full (200)",
    Value = false,
    Callback = function(Value)
        autoSellEnabled = Value
        if autoSellEnabled then
            autoSellThread = task.spawn(function()
                while autoSellEnabled and task.wait(1) do
                    if isInventoryFull() then sellItems() end
                end
            end)
        elseif autoSellThread then task.cancel(autoSellThread) end
    end
})
Tabs.MainTab:Paragraph({ Title = "Exclude Mutations or Fruits", Desc = "Configure which mutations or fruits to ignore" })
Tabs.MainTab:Dropdown({
    Title = "Exclude Mutations In Collecting",
    Values = mutationOptions,
    Value = {},
    Multi = true,
    AllowNone = true,
    Callback = function(selectedOptions)
        ignoredMutations = selectedOptions
        updatePromptsForMutations()
    end
})
Tabs.MainTab:Toggle({
    Title = "Ignore Selected Mutations",
    Value = false,
    Callback = function(state)
        ignoreMutationsEnabled = state
        updatePromptsForMutations()
    end
})
Tabs.MainTab:Toggle({
    Title = "Ignore Every Plant",
    Desc = "For mobile or PC",
    Value = false,
    Callback = function(state)
        allPromptsDisabled = state
        updatePromptsForMutations()
    end
})
Tabs.MainTab:Paragraph({ Title = "Insta Sell", Desc = "Instantly sell items or pets" })
Tabs.MainTab:Button({ Title = "Insta Sell", Callback = SellAll })
Tabs.MainTab:Button({ Title = "Insta Sell Hand", Callback = HSell })
Tabs.MainTab:Button({
    Title = "Sell Pets",
    Desc = "Sells all eligible pets in your backpack that are not favorited",
    Callback = function()
        local p = lp
        local b = p:WaitForChild("Backpack")
        local c = p.Character or p.CharacterAdded:Wait()
        local pets = {}
        for _, t in ipairs(b:GetChildren()) do
            if t:IsA("Tool") and t:FindFirstChild("PetToolLocal") and string.match(t.Name, "%[Age%s%d+%]") then
                if t:GetAttribute("Favorite") ~= true then
                    t.Parent = c
                    table.insert(pets, t)
                end
            end
        end
        c:PivotTo(CFrame.new(62, 3, 0))
        task.wait(0.3)
        local e = GameEvents:WaitForChild("SellPet_RE")
        for _, t in ipairs(pets) do 
            if t and t:IsDescendantOf(c) then 
                e:FireServer(t) 
            end 
        end
        WindUI:Notify({
            Title = "Pet Seller",
            Content = "Pet selling process completed! Favorited pets were skipped.",
            Duration = 3
        })
    end
})
Tabs.MainTab:Paragraph({ Title = "Others", Desc = "Additional features" })
Tabs.MainTab:Dropdown({
    Title = "Select Mutations (Auto Fav)",
    Values = mutationOptions,
    Value = selectedMutations,
    Multi = true,
    AllowNone = true,
    Callback = function(Options)
        selectedMutations = Options
        if autoFavoriteEnabled then processBackpack() end
    end
})
Tabs.MainTab:Toggle({
    Title = "Auto-Favorite",
    Value = false,
    Callback = function(Value)
        autoFavoriteEnabled = Value
        if Value then setupAutoFavorite() elseif connection then connection:Disconnect() connection = nil end
    end
})
Tabs.MainTab:Button({
    Title = "Unfav all",
    Callback = function()
        local backpack = lp:WaitForChild("Backpack")
        for _, tool in ipairs(backpack:GetChildren()) do
            local isFavorited = tool:GetAttribute("Favorite") or (tool:FindFirstChild("Favorite") and tool.Favorite.Value)
            if isFavorited then
                favoriteEvent:FireServer(tool)
                task.wait()
            end
        end
    end
})
Tabs.MainTab:Toggle({
    Title = "One Click Plant Remove",
    Desc = "Be careful! Hope you don't delete something you needed!",
    Value = false,
    Callback = OneClickRemove
})
Tabs.MainTab:Button({ Title = "Stop Grow-ALL Pop-up", Callback = DestroySign })

-- Shop Tab
Tabs.ShopTab:Paragraph({ Title = "Auto Buy", Desc = "Automate purchasing of items" })
Tabs.ShopTab:Dropdown({
    Title = "Select Seeds",
    Desc = "Choose which seeds to auto buy",
    Values = seedItems,
    Value = selectedSeeds,
    Multi = true,
    AllowNone = true,
    Callback = function(Options) selectedSeeds = Options end
})
Tabs.ShopTab:Dropdown({
    Title = "Select Gear",
    Desc = "Choose which gear to auto buy",
    Values = gearItems,
    Value = selectedGears,
    Multi = true,
    AllowNone = true,
    Callback = function(Options) selectedGears = Options end
})
Tabs.ShopTab:Dropdown({
    Title = "Select Twilight",
    Desc = "Choose which twilight items to auto buy",
    Values = TwilightItems,
    Value = selectedTwilight,
    Multi = true,
    AllowNone = true,
    Callback = function(Options) selectedTwilight = Options end
})
Tabs.ShopTab:Toggle({
    Title = "Auto Buy",
    Value = false,
    Callback = function(Value)
        autoBuyEnabled = Value
        if autoBuyEnabled then
            spawn(function()
                while autoBuyEnabled do
                    for _, seed in ipairs(selectedSeeds) do
                        if autoBuyEnabled then
                            seedRemote:FireServer(seed)
                            wait(0.01)
                        end
                    end
                    for _, twilight in ipairs(selectedTwilight) do
                        if autoBuyEnabled then
                            TwilightRemote:FireServer(twilight)
                            wait(0.01)
                        end
                    end
                    for _, gear in ipairs(selectedGears) do
                        if autoBuyEnabled then
                            gearRemote:FireServer(gear)
                            wait(0.01)
                        end
                    end
                end
            end)
        end
    end
})
Tabs.ShopTab:Toggle({
    Title = "Auto Buy Twilight",
    Value = false,
    Callback = function(Value)
        autoBuyEnabled = Value
        if autoBuyEnabled then
            spawn(function()
                while autoBuyEnabled do
                    for _, twilight in ipairs(selectedTwilight) do
                        if autoBuyEnabled then
                            TwilightRemote:FireServer(twilight)
                            wait(0.01)
                        end
                    end
                end
            end)
        end
    end
})
Tabs.ShopTab:Toggle({
    Title = "Auto Buy Eggs",
    Value = false,
    Callback = function(value)
        Autoegg_autoBuyEnabled = value
        if Autoegg_autoBuyEnabled then Autoegg_firstRun = true Autoegg_autoBuyEggs() end
    end
})
Tabs.ShopTab:Paragraph({ Title = "Cosmetic", Desc = "Cosmetic shop options" })
Tabs.ShopTab:Button({ Title = "Open Cosmetic Shop", Callback = OpenCosmetic })
Tabs.ShopTab:Button({
    Title = "Buy Cosmetic Items x5",
    Desc = "In Stock it'll also drain your sheckles",
    Callback = function()
        for _, s in ipairs({lp.PlayerGui.CosmeticShop_UI.CosmeticShop.Main.Holder.Shop.ContentFrame.TopSegment, lp.PlayerGui.CosmeticShop_UI.CosmeticShop.Main.Holder.Shop.ContentFrame.BottomSegment}) do
            for _ = 1, 5 do
                for _, f in ipairs(s:GetChildren()) do
                    if f:IsA("Frame") then
                        GameEvents.BuyCosmeticItem:FireServer(f.Name)
                        if f.Name:find("Crate") then
                            GameEvents.BuyCosmeticCrate:FireServer(f.Name)
                        end
                    end
                end
            end
        end
    end
})
Tabs.ShopTab:Button({
    Title = "Teleport to Cosmetic",
    Callback = function()
        local player = Players.LocalPlayer
        local character = player.Character
        if character and character:FindFirstChild("HumanoidRootPart") then
            character.HumanoidRootPart.CFrame = CFrame.new(Vector3.new(-287, 3, -15))
        else
            warn("Character or HumanoidRootPart not found.")
        end
    end
})
Tabs.ShopTab:Paragraph({ Title = "Events", Desc = "Event shop options" })
Tabs.ShopTab:Button({ Title = "Open BloodShop", Callback = OpenBloodShop })
Tabs.ShopTab:Button({ Title = "Open Twilight Shop", Callback = OpenTwilight })
Tabs.ShopTab:Button({ Title = "Open Twilight Quest", Callback = OpenTwilightQuest })
Tabs.ShopTab:Paragraph({ Title = "Menus", Desc = "Open various shops and menus" })
Tabs.ShopTab:Button({ Title = "Open Egg Shop 1", Desc = "Click again to close", Callback = EggShop1 })
Tabs.ShopTab:Button({ Title = "Open Egg Shop 2", Desc = "Click again to close", Callback = EggShop2 })
Tabs.ShopTab:Button({ Title = "Open Egg Shop 3", Desc = "Click again to close", Callback = EggShop3 })
Tabs.ShopTab:Button({ Title = "Open Seed Shop", Desc = "Click again to close", Callback = OpenShop })
Tabs.ShopTab:Button({ Title = "Open Gear Shop", Desc = "Click again to close", Callback = OpenGearShop })
Tabs.ShopTab:Button({ Title = "Open Quest", Desc = "Click again to close", Callback = OpenQuest })

-- Player Tab
Tabs.PlayerTab:Paragraph({ Title = "Movement", Desc = "Player movement settings" })
Tabs.PlayerTab:Toggle({
    Title = "Fly",
    Value = false,
    Callback = Fly
})
Tabs.PlayerTab:Toggle({
    Title = "No Clip",
    Value = false,
    Callback = ToggleNoclip
})
Tabs.PlayerTab:Toggle({
    Title = "Infinite Jump",
    Value = false,
    Callback = ToggleInfJump
})
Tabs.PlayerTab:Slider({
    Title = "Player Speed",
    Value = { Min = 0, Max = 200, Default = 16 },
    Callback = function(value)
        local char = lp.Character
        if char and char:FindFirstChildOfClass("Humanoid") then
            char:FindFirstChildOfClass("Humanoid").WalkSpeed = value
        end
    end
})
Tabs.PlayerTab:Slider({
    Title = "Jump Height",
    Value = { Min = 0, Max = 200, Default = 50 },
    Callback = function(value)
        local char = lp.Character
        if char and char:FindFirstChildOfClass("Humanoid") then
            char:FindFirstChildOfClass("Humanoid").JumpPower = value
        end
    end
})

-- Misc Tab
Tabs.MiscTab:Paragraph({ Title = "Plants", Desc = "Plant automation settings" })
Tabs.MiscTab:Dropdown({
    Title = "Select Seeds to Plant",
    Desc = "Seeds to plant",
    Values = seedNames,
    Value = {},
    Multi = true,
    AllowNone = true,
    Callback = function(opts) SelectedSeeds = opts end
})
Tabs.MiscTab:Toggle({
    Title = "Auto Plant",
    Desc = "Fly and No Clip recommended to avoid glitches from growing crops",
    Value = false,
    Callback = function(state)
        AutoPlanting = state
        if state then startAutoPlanting() end
    end
})
Tabs.MiscTab:Toggle({
    Title = "Auto Submit Plant",
    Value = false,
    Callback = AutoGiveFruitMoon
})
Tabs.MiscTab:Button({
    Title = "Submit All Moon Fruits",
    Desc = "Submits All Moon Fruits Of Yours",
    Callback = function()
        local args = { "SubmitAllPlants" }
        game:GetService("ReplicatedStorage"):WaitForChild("Remotes"):WaitForChild("NightQuestRemoteEvent"):FireServer(unpack(args))
    end
})
Tabs.MiscTab:Paragraph({ Title = "Extras", Desc = "Additional utilities" })
Tabs.MiscTab:Button({
    Title = "AntiAfk",
    Desc = "Press Once Only",
    Callback = function()
        local success, error = pcall(function()
            loadstring(game:HttpGet("https://raw.githubusercontent.com/hassanxzayn-lua/Anti-afk/main/antiafkbyhassanxzyn"))()
        end)
        WindUI:Notify({
            Title = success and "Anti Afk" or "Error",
            Content = success and "Anti Afk script executed successfully!" or "Failed to execute Anti Afk script: " .. tostring(error),
            Duration = 5,
            Icon = success and "rewind" or "alert-triangle"
        })
    end
})
Tabs.MiscTab:Button({
    Title = "ServerHop",
    Callback = function()
        local success, error = pcall(function()
            loadstring(game:HttpGet("https://raw.githubusercontent.com/Spectrum-Trash/Addons/refs/heads/main/FindServer.lua"))()
        end)
        WindUI:Notify({
            Title = success and "Server Finder" or "Error",
            Content = success and "Server Finder script executed successfully!" or "Failed to execute Server Finder script: " .. tostring(error),
            Duration = 5,
            Icon = success and "rewind" or "alert-triangle"
        })
    end
})
Tabs.MiscTab:Button({ Title = "ServerHop V2", Callback = ServerHop })
Tabs.MiscTab:Paragraph({ Title = "Purchase Stuff", Desc = "Purchase items with Robux (DM if you receive the item)" })
Tabs.MiscTab:Button({
    Title = "Buy Candy Blossom With Robux",
    Desc = "Click to purchase",
    Callback = function()
        local MarketplaceService = game:GetService("MarketplaceService")
        pcall(function() MarketplaceService:PromptProductPurchase(lp, ProductId) end)
    end
})
Tabs.MiscTab:Button({
    Title = "Buy Bug Egg",
    Desc = "Click to purchase",
    Callback = function()
        local MarketplaceService = game:GetService("MarketplaceService")
        pcall(function() MarketplaceService:PromptProductPurchase(lp, 3277000452) end)
    end
})
Tabs.MiscTab:Button({
    Title = "Buy Skip Expander Timer (1day)",
    Desc = "Click to purchase",
    Callback = function()
        local MarketplaceService = game:GetService("MarketplaceService")
        pcall(function() MarketplaceService:PromptProductPurchase(lp, 3290577633) end)
    end
})
Tabs.MiscTab:Button({
    Title = "Buy Skip Expander Timer (3days)",
    Desc = "Click to purchase",
    Callback = function()
        local MarketplaceService = game:GetService("MarketplaceService")
        pcall(function() MarketplaceService:PromptProductPurchase(lp, 3290619407) end)
    end
})

-- Spawner Tab
Tabs.SpawnerTab:Paragraph({ Title = "Seed Spawner", Desc = "Spawn custom seeds" })
Tabs.SpawnerTab:Input({
    Title = "Seed Name",
    Desc = "Without the Seed (e.g., Candy Blossom)",
    Placeholder = "Name",
    Value = "",
    Callback = function(t) seedName = t end
})
Tabs.SpawnerTab:Input({
    Title = "Quantity",
    Placeholder = "Amount",
    Value = "",
    Callback = function(t) seedAmount = tonumber(t) or 0 end
})
Tabs.SpawnerTab:Button({
    Title = "Spawn Seeds",
    Callback = function()
        if seedName == "" or seedAmount <= 0 then return end
        local m = game:GetService("ReplicatedStorage"):FindFirstChild("Seed_Models"):FindFirstChild(seedName)
        if not m then warn("no model:", seedName) return end
        local t = Instance.new("Tool")
        t.Name = seedName .. " Seed [x" .. seedAmount .. "]"
        t.RequiresHandle = true
        local c = m:Clone()
        local h = c:IsA("Part") and c or c:FindFirstChildWhichIsA("Part")
        if not h then warn("no handle lololol") return end
        h.Name = "Handle"
        h.Anchored = false
        h.CanCollide = false
        h.Massless = true
        h.Parent = t
        t.Grip = CFrame.new(0.2, -0.449, 0.232) * CFrame.Angles(0, math.rad(0), 0)
        t.Parent = game.Players.LocalPlayer.Backpack
    end
})
Tabs.SpawnerTab:Paragraph({ Title = "Pet Spawner", Desc = "Spawn custom pets (visual only)" })
Tabs.SpawnerTab:Input({
    Title = "Pet Name",
    Placeholder = "e.g., Raccoon",
    Value = "",
    Callback = function(t) PetName = t end
})
Tabs.SpawnerTab:Input({
    Title = "Pet Weight",
    Placeholder = "e.g., 2",
    Value = "",
    Callback = function(t) PetWeight = t end
})
Tabs.SpawnerTab:Input({
    Title = "Pet Age",
    Placeholder = "e.g., 3",
    Value = "",
    Callback = function(t) PetAge = t end
})
Tabs.SpawnerTab:Button({
    Title = "Spawn Pet",
    Callback = function()
        local player = Players.LocalPlayer
        local backpack = player:WaitForChild("Backpack")
        local RS = game:GetService("ReplicatedStorage")
        local Models = RS:WaitForChild("Assets"):WaitForChild("Models"):WaitForChild("PetAssets")
        local Anims = RS:WaitForChild("Assets"):WaitForChild("Animations"):WaitForChild("PetAnimations")
        local petModel = Models:FindFirstChild(PetName)
        if not petModel then
            WindUI:Notify({
                Title = "Error",
                Content = "Pet not found: " .. PetName,
                Duration = 3,
                Icon = "alert-triangle"
            })
            return
        end
        local pet = petModel:Clone()
        local root = pet:FindFirstChild("RootPart")
        if not root then
            WindUI:Notify({
                Title = "Error",
                Content = "No RootPart found in pet model",
                Duration = 3,
                Icon = "alert-triangle"
            })
            return
        end
        root.Name = "Handle"
        pet.PrimaryPart = root
        local weight = tonumber(PetWeight) or 1
        pet:ScaleTo(1 + 0.05 * (weight / 0.5) + (weight - math.floor(weight)))
        local tool = Instance.new("Tool")
        tool.Name = ("%s\n[%s KG]\n[Age %s]"):format(PetName, PetWeight, PetAge)
        tool.RequiresHandle = true
        if PetName:lower() == "dragonfly" then
            tool.Grip = CFrame.new(0, -3, 0) * CFrame.Angles(math.rad(90), 0, 29.7)
        else
            tool.Grip = CFrame.Angles(math.rad(90), 0, math.rad(-90))
        end
        tool.Parent = backpack
        for _, part in ipairs(pet:GetChildren()) do
            part.Parent = tool
        end
        pet:Destroy()
        tool.Equipped:Connect(function()
            local animCtrl = tool:FindFirstChildWhichIsA("AnimationController", true) or Instance.new("AnimationController", tool)
            animCtrl.Name = PetName .. "Controller"
            local animator = animCtrl:FindFirstChildOfClass("Animator") or Instance.new("Animator", animCtrl)
            local animName = ({["fox"] = true, ["red fox"] = true})[PetName:lower()] and "Fox" or PetName
            local folder = Anims:FindFirstChild(animName)
            if folder and folder:FindFirstChild("Idle") then
                local anim = Instance.new("Animation", tool)
                anim.AnimationId = folder.Idle.AnimationId
                local track = animator:LoadAnimation(anim)
                track.Looped = true
                track:Play()
            else
                warn("No idle animation found for: " .. animName)
            end
        end)
        WindUI:Notify({
            Title = "Success",
            Content = "Spawned pet '" .. PetName .. "' in your backpack!",
            Duration = 3,
            Icon = "check"
        })
    end
})
Tabs.SpawnerTab:Paragraph({ Title = "Notes", Desc = "Pet spawning is visual only and may not have full functionality." })

-- Visuals Tab
Tabs.VisualsTab:Paragraph({ Title = "Mutation ESP", Desc = "Visualize mutations on fruits" })
Tabs.VisualsTab:Toggle({
    Title = "Enable ESP",
    Value = false,
    Callback = function(state)
        state.espEnabled = state
        updateESP()
        if state then
            task.spawn(function()
                while state.espEnabled do
                    updateESP()
                    checkForMutations()
                    task.wait(1)
                end
            end)
        end
    end
})
Tabs.VisualsTab:Dropdown({
    Title = "Select Mutations for ESP",
    Values = mutationOptions,
    Value = state.selectedMutations,
    Multi = true,
    AllowNone = true,
    Callback = function(selectedOptions)
        state.selectedMutations = selectedOptions
        updateESP()
    end
})
Tabs.VisualsTab:Input({
    Title = "Webhook URL",
    Placeholder = "Enter Discord webhook URL",
    Value = "",
    Callback = function(url)
        state.webhookUrl = url
        WindUI:Notify({
            Title = "Webhook Updated",
            Content = "Webhook URL set successfully.",
            Duration = 3,
            Icon = "check"
        })
    end
})
Tabs.VisualsTab:Paragraph({ Title = "Mutation Counts", Desc = "Displays the count of each mutation type" })
Tabs.VisualsTab:Button({
    Title = "Update Mutation Counts",
    Callback = function()
        local countText = updateMutationCounts()
        WindUI:Notify({
            Title = "Mutation Counts",
            Content = countText,
            Duration = 5,
            Icon = "info"
        })
    end
})

-- Cleanup on Script Termination
game:BindToClose(function()
    -- Disconnect connections
    if farmThread then task.cancel(farmThread) end
    if fastClickThread then task.cancel(fastClickThread) end
    if autoSellThread then task.cancel(autoSellThread) end
    if HarvestConnection then HarvestConnection:Disconnect() end
    if flightConnection then flightConnection:Disconnect() end
    if collectionThread then task.cancel(collectionThread) end
    if descendantConnection then descendantConnection:Disconnect() end
    if connection then connection:Disconnect() end
    if claimConnection then claimConnection:Disconnect() end
    -- Disable fly and noclip
    Fly(false)
    ToggleNoclip(false)
    -- Clear ESP
    for _, billboard in pairs(state.espBillboards) do billboard:Destroy() end
    for _, highlight in pairs(state.espHighlights) do highlight:Destroy() end
    table.clear(state.espBillboards)
    table.clear(state.espHighlights)
    -- Restore prompts
    for prompt, data in pairs(promptTracker) do
        if prompt:IsA("ProximityPrompt") then
            pcall(function() prompt.RequiresLineOfSight = data.originalRequiresLOS prompt.Exclusivity = data.originalExclusivity end)
        end
    end
end)